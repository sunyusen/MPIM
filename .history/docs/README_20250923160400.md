# MPIM 项目文档

## 文档目录

### 架构设计

- [系统整体架构](architecture/overview.md) - 系统整体架构设计和分层说明
- [系统整体架构-增强版](architecture/overview-enhanced.md) - 增强版分层架构图，包含详细组件关系和交互流程
- [消息流转机制](architecture/message-flow.md) - 消息流转的详细流程和时序图
- [消息流转机制-增强版](architecture/message-flow-enhanced.md) - 增强版消息流转架构，包含性能优化和可靠性保障
- [RPC框架设计](architecture/rpc-framework.md) - 自研RPC框架的架构和实现
- [RPC框架详细设计](architecture/rpc-framework-detailed.md) - RPC框架的详细实现和优化
- [mprpc 完整框架文档](architecture/mprpc-framework-complete.md) - 架构/原理/实现/优化/TODO
- [mprpc 调用序列图](architecture/mprpc-call-sequence.md) - RPC 端到端调用时序
- [数据存储架构](architecture/data-storage.md) - Redis+MySQL混合存储架构
- [Redis缓存架构](architecture/redis-cache-architecture.md) - Redis缓存系统设计和实现
- [Redis双重功能架构](architecture/redis-dual-function-architecture.md) - Redis缓存+消息队列双重功能设计
- [Redis双重功能架构-增强版](architecture/redis-dual-function-enhanced.md) - 增强版Redis双重功能架构，包含详细的功能分解和性能优化
- [ZooKeeper服务发现](architecture/zookeeper-service-discovery.md) - ZooKeeper服务注册发现机制
- [ZooKeeper一致性机制](architecture/zookeeper-consistency-mechanism.md) - ZooKeeper一致性保证机制
- [ZooKeeper在MPIM中的角色](architecture/zookeeper-role-in-mpim.md) - ZooKeeper在项目中的具体角色分析
- [网关服务架构](architecture/gateway-service-architecture.md) - 网关接入服务设计与RPC交互
- [用户服务架构](architecture/user-service-architecture.md) - 用户管理服务详细设计
- [群组服务架构](architecture/group-service-architecture.md) - 群组管理服务详细设计
- [消息服务架构](architecture/message-service-architecture.md) - 消息处理服务详细设计
- [Presence服务架构](architecture/presence-service-architecture.md) - 在线状态和路由管理服务详细设计
- [Redis 分层与位置澄清](architecture/redis-separation.md) - 缓存层与消息队列层分离
- [分层架构含 Redis](architecture/layered-architecture-with-redis.md)
- [架构改进清单](architecture/architecture-improvements.md)

### 分布式系统理论
- [CAP定理与MPIM系统设计分析](distributed-systems/cap-theorem-analysis.md) - CAP定理基础理论及在MPIM项目中的具体应用
- [RPC框架设计与MPIM自研实现分析](distributed-systems/rpc-framework-analysis.md) - RPC框架设计原理及MPIM自研RPC框架的详细实现
- [服务注册发现与ZooKeeper应用分析](distributed-systems/service-discovery-analysis.md) - 服务注册发现机制及ZooKeeper在MPIM项目中的应用
- [消息队列与Redis应用分析](distributed-systems/message-queue-analysis.md) - 消息队列原理及Redis在MPIM项目中的双重功能应用
- [缓存系统与Redis应用分析](distributed-systems/cache-system-analysis.md) - 缓存系统设计及Redis缓存层在MPIM项目中的实现
- [微服务架构与MPIM设计分析](distributed-systems/microservices-architecture-analysis.md) - 微服务架构原理及MPIM微服务设计实践
- [负载均衡与Nginx应用分析](distributed-systems/load-balancing-analysis.md) - 负载均衡原理及Nginx在MPIM项目中的应用
- [分布式锁理论分析](distributed-systems/distributed-lock-theory.md) - 分布式锁原理及在MPIM项目中的潜在应用场景
- [BASE理论与最终一致性分析](distributed-systems/base-theory-analysis.md) - BASE理论及MPIM项目中的最终一致性实现
- [分布式事务与ACID分析](distributed-systems/distributed-transaction-analysis.md) - 分布式事务原理及MPIM项目中的事务处理
- [分布式一致性算法分析](distributed-systems/distributed-consensus-algorithms.md) - Paxos、Raft、PBFT算法原理及ZooKeeper的ZAB协议
- [分布式存储系统分析](distributed-systems/distributed-storage-analysis.md) - 分布式存储原理及MPIM项目中的存储设计
- [分布式监控与追踪分析](distributed-systems/distributed-monitoring-tracing.md) - 监控指标体系及MPIM项目中的监控实现

### 服务模块设计
- [用户服务架构](architecture/user-service-architecture.md)
- [群组服务架构](architecture/group-service-architecture.md)
- [消息服务架构](architecture/message-service-architecture.md)
- [网关服务架构](architecture/gateway-service-architecture.md)
- [Presence服务架构](architecture/presence-service-architecture.md)

### 核心技术
- [Protobuf在MPIM项目中的应用分析](technology/protobuf-analysis.md) - Protobuf序列化技术及在项目中的具体应用
- [Muduo 深入解析与实践](architecture/muduo-deep-dive.md)

### 性能优化
- [性能优化报告](performance/optimization.md) - 性能优化手段和测试结果

### 部署运维
- [部署架构设计](deployment/architecture.md) - 生产环境部署架构和容器化方案

### 分布式系统理论（快速入口）

- [CAP定理与MPIM系统设计分析](distributed-systems/cap-theorem-analysis.md)
- [RPC框架设计与MPIM自研实现分析](distributed-systems/rpc-framework-analysis.md)
- [服务注册发现与ZooKeeper应用分析](distributed-systems/service-discovery-analysis.md)
- [消息队列与Redis应用分析](distributed-systems/message-queue-analysis.md)
- [缓存系统与Redis应用分析](distributed-systems/cache-system-analysis.md)
- [微服务架构与MPIM设计分析](distributed-systems/microservices-architecture-analysis.md)
- [负载均衡与Nginx应用分析](distributed-systems/load-balancing-analysis.md)
- [分布式锁理论分析](distributed-systems/distributed-lock-theory.md)
- [BASE理论与最终一致性分析](distributed-systems/base-theory-analysis.md)
- [分布式事务与ACID分析](distributed-systems/distributed-transaction-analysis.md)
- [分布式一致性算法分析](distributed-systems/distributed-consensus-algorithms.md)
- [分布式存储系统分析](distributed-systems/distributed-storage-analysis.md)
- [分布式监控与追踪分析](distributed-systems/distributed-monitoring-tracing.md)
- [分布式系统阅读索引](distributed-systems/README.md)

### 全量清单（A–Z 索引）
以下为 docs/ 目录下全部 Markdown 文件的平铺索引，便于快速定位：

- architecture/architecture-improvements.md
- architecture/data-storage.md
- architecture/gateway-service-architecture.md
- architecture/group-service-architecture.md
- architecture/layered-architecture-with-redis.md
- architecture/message-flow-enhanced.md
- architecture/message-flow.md
- architecture/message-service-architecture.md
- architecture/mprpc-call-sequence.md
- architecture/mprpc-framework-complete.md
- architecture/muduo-deep-dive.md
- architecture/overview-enhanced.md
- architecture/overview.md
- architecture/presence-module-architecture.md
- architecture/presence-service-architecture.md
- architecture/redis-cache-architecture.md
- architecture/redis-dual-function-architecture.md
- architecture/redis-dual-function-enhanced.md
- architecture/redis-separation.md
- architecture/rpc-framework-detailed.md
- architecture/rpc-framework.md
- architecture/zookeeper-consistency-mechanism.md
- architecture/zookeeper-role-in-mpim.md
- architecture/zookeeper-service-discovery.md
- deployment/architecture.md
- distributed-systems/README.md
- distributed-systems/base-theory-analysis.md
- distributed-systems/cache-system-analysis.md
- distributed-systems/cap-theorem-analysis.md
- distributed-systems/distributed-consensus-algorithms.md
- distributed-systems/distributed-lock-theory.md
- distributed-systems/distributed-monitoring-tracing.md
- distributed-systems/distributed-storage-analysis.md
- distributed-systems/distributed-transaction-analysis.md
- distributed-systems/load-balancing-analysis.md
- distributed-systems/message-queue-analysis.md
- distributed-systems/microservices-architecture-analysis.md
- distributed-systems/rpc-framework-analysis.md
- performance/optimization.md
- technology/protobuf-analysis.md

## 快速开始

### 1. 环境要求
- CentOS 7+ / Ubuntu 18+
- Redis 6.2.6+
- MySQL 8.0+
- ZooKeeper 3.6+
- GCC 11+ (支持C++17)

### 2. 快速部署

```bash
# 克隆项目
git clone https://github.com/yourname/mpim.git
cd mpim

# 安装依赖
./scripts/install_deps.sh

# 启动服务
./bin/start.sh
```

### 3. 验证部署

```bash
# 检查服务状态
./scripts/health_check.sh

# 运行测试
./bin/test_client
```

## 项目特点

- **微服务架构**: 服务解耦、独立部署、易于扩展
- **高性能**: RPC性能提升43倍，延迟降低87%
- **高可用**: 服务集群部署，支持故障转移
- **实时性**: 基于Redis pub/sub的毫秒级消息投递
- **智能缓存**: Redis缓存减少80%+数据库查询，响应时间 < 1ms
- **可扩展**: 支持水平扩展，动态负载均衡

## 性能指标

| 指标 | 优化前 | 优化后 | 提升 |
|------|--------|--------|------|
| QPS | 622 | 26,850 | 43倍 |
| P99延迟 | 33ms | 2.6ms | 87% |
| 缓存命中率 | 0% | 90%+ | 新增 |
| 缓存响应时间 | N/A | < 1ms | 新增 |
| 并发连接 | 100 | 10,000+ | 100倍 |
| 消息吞吐 | 1,000/s | 100,000+/s | 100倍 |

## 技术栈

- **开发语言**: C++17
- **网络库**: Muduo
- **RPC框架**: 自研 (基于protobuf)
- **服务发现**: ZooKeeper
- **消息队列**: Redis pub/sub
- **数据存储**: MySQL + Redis
- **缓存系统**: Redis (用户信息、好友关系、群组数据)
- **容器化**: Docker + Kubernetes
- **监控**: Prometheus + Grafana

## 贡献指南

1. Fork 项目
2. 创建功能分支
3. 提交代码
4. 创建 Pull Request

## 许可证

MIT License

## 联系方式

- 作者: glf
- 邮箱: 3103422118@qq.com
- 项目地址: <https://github.com/sunyusen/mpim>
