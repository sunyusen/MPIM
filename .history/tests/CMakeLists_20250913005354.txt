# 测试配置
if(MPIM_BUILD_TESTS)
    # 功能测试
    add_executable(test_mpim_functionality
        test_mpim_functionality.cc
    )
    
    target_include_directories(test_mpim_functionality PRIVATE
        ${CMAKE_SOURCE_DIR}/im-common/include
        ${CMAKE_SOURCE_DIR}/mprpc/include
        ${CMAKE_SOURCE_DIR}/thirdparty/include
    )
    
    target_link_libraries(test_mpim_functionality PRIVATE
        GTest::gtest
        GTest::gtest_main
        pthread
    )
    
    # 添加测试到CTest
    add_test(NAME MPIMFunctionalityTest COMMAND test_mpim_functionality)
    
    # 设置测试属性
    set_tests_properties(MPIMFunctionalityTest PROPERTIES
        TIMEOUT 60
        WORKING_DIRECTORY ${CMAKE_BINARY_DIR}
    )
endif()
